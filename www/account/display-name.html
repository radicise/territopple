<!DOCTYPE html>
<html>
    <head>
        <script src="/_icons.js"></script>
        <title>Territopple - Change Display Name</title>
    </head>
    <body>
        <h1>Change Display Name</h1>
        <p id="msg"></p>
        <div id="form-container">
           <label for="display-name">New Display Name:</label>
<input type="text" id="display-name"><br>

<input type="button" value="Update" id="display-submit">

        </div>
        <p>Don't have an account? <a href="/account/create" target="_self">create one</a> or <a href="/" target="_self">return home</a>.<br>Forgot password? <a href="/account/password-reset" target="_self">reset it here</a>.</p>
        <script>
            fetch("https://territopple.net/acc/pub/logged-in", {method:"GET"}).then(v => {
                if (v.status === 200) {
                    location.href = "/";
                }
            });
            const id = document.getElementById("cf-id");
            const pw = document.getElementById("cf-pw");
            const msg = document.getElementById("msg");
            document.getElementById("cf-submit").addEventListener("click", () => {
                if ([id,pw].some(v => !v.value)) {
                    return;
                }
                fetch("https://territopple.net/acc/login", {method:"POST",headers:[["Content-Type","application/json"]],body:JSON.stringify({"id":id.value,"pw":pw.value})}).then(v => {
                    if (v.status === 200) {
                        msg.textContent = "logged in, redirecting soon";
                        location.href = "/account/info";
                    } else if (v.status === 403) {
                        msg.textContent = "incorrect credentials";
                    } else if (v.status === 500) {
                        msg.textContent = "server error";
                    } else if (v.status === 422) {
                        msg.textContent = "bad JSON";
                    } else if (v.status === 400) {
                        msg.textContent = "sec fail";
                    } else if (v.status === 404) {
                        msg.textContent = "account not found";
                    }
                });
            });
        </script>
    <script src="display-name.js"></script>

    </body>
</html>
