<!DOCTYPE html>
<html>
    <head>
        <script src="/_icons.js"></script>
        <title>Home - Territopple</title>
        <style>
            ul.credit-list {
                list-style: none outside;
                margin-top: 0.25em;
                padding-left: 0.75em;
            }
            div.modal {
                position: absolute;
                left: 0px;
                top: 0px;
                width: 100vw;
                height: 100vh;
                background-color: #33333388;
            }
            div.modal > div {
                position: absolute;
                left: 50vw;
                top: 50vh;
                transform: translate(-50%, -50%);
                background-color: #fff;
                border: inset gray 2px;
                padding: 5px;
            }
            a.perma-blue:visited {
                color: LinkText;
            }
            a.button-link, a.button-link:visited {
                color: darkgray;
                text-decoration: none;
            }
            a.button-link:hover {
                color: dimgray;
                text-decoration: underline;
                cursor: pointer;
            }
        </style>
        <style>
            div#splash-banner {
                --left: 10vw;
                margin-left: var(--left);
                width: calc(100vw - var(--left) - 16px);
                /* justify-items: center; */
            }
            div#splash-banner > h1#splash-main {
                width: fit-content;
            }
        </style>
        <style>
            div#play-options {
                display: flex;
                flex-direction: column;
                width: max-content;
                margin-left: 3em;
            }
            div#play-options > *:not(:first-child) {
                margin-top: 0.5em;
            }
            div#contact-footer {
                position: absolute;
                width: calc(100vw - 2em);
                left: 0px;
                bottom: 0px;
                /* margin: 1em; */
                padding: 1em;
                /* margin-right: 0.5em;
                margin-left: 1.5em; */
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                justify-items: left;
                border-top: solid gray 2px;
                /* margin-top: 0em; */
                padding-top: 1em;
                /* display: flex;
                justify-content: space-between;
                flex-wrap: wrap; */
            }
            div#contact-footer > * {
                /* margin-left: 5px; */
                display: flex;
                flex-direction: column;
                width: max-content;
                justify-self: center;
            }
            #test {
                position:absolute;
                left:calc(50vw - 2.5px);
                width:5px;
                background-color: black;
                height:100vh;
                top:0px;
            }
        </style>
        <style>
            div#random-replay {
                --size: 75vmin;
                width: var(--size);
                height: var(--size);
                border: inset black 3px;
                margin-right: 2px;
                position: absolute;
                right: 0px;
                top: 50vh;
                transform: translateY(-50%);
                align-content: center;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <!-- <meta data-import="/components/display-settings.html" /> -->
        <!-- <meta data-import="/components/display-settings.html" data-scripts="/displaycontrols.js" /> -->
        <!-- <div id="test"></div> -->
        <meta data-import="/components/accounts/disp.html" />
        <div id="splash-banner">
            <h1 id="splash-main">Territopple (Alpha 1.09.21.25.1)</h1>
        </div>
        <div id="play-options">
            <input type="button" value="Play Online" onclick="location.href='/play-online'">
            <input type="button" value="Puzzles" disabled>
            <input type="button" value="Reference / Guide" onclick="location.href='/help'">
            <input type="button" value="Watch Replay" onclick="location.href='/replay'">
        </div>
        <div id="random-replay">
            Coming Soon!
        </div>
        <div id="contact-footer">
            <!-- <input type="button" value="Contact Server Operator" onclick="document.getElementById('contact-modal').hidden=false;"> -->
            <div>
                <a onclick="document.getElementById('cookie-modal').hidden=false;" class="button-link">Cookie Usage</a>
                <a onclick="document.getElementById('contact-modal').hidden=false;" class="button-link">Contact Server Operator</a>
            </div>
            <div>
                <a onclick="document.getElementById('coming-soon-modal').hidden=false;" class="button-link">Want To Host Your Own Server?</a>
                <a onclick="document.getElementById('changelog-modal').hidden=false;" class="button-link">Changelog</a>
            </div>
            <div>
                <a target="_blank" href="https://github.com/radicise/territopple" class="button-link">Check Out The GitHub!</a>
                <a onclick="document.getElementById('credits-modal').hidden=false;" class="button-link">About & Credits</a>
            </div>
            <!-- <a onclick="window.alert('not implemented yet');" class="button-link">Want To Host Your Own Server?</a>
            <a onclick="window.alert('not implemented yet');" class="button-link">Want To Host Your Own Server?</a>
            <a onclick="window.alert('not implemented yet');" class="button-link">Want To Host Your Own Server?</a>
            <a onclick="window.alert('not implemented yet');" class="button-link">Want To Host Your Own Server?</a>
            <a onclick="window.alert('not implemented yet');" class="button-link">Want To Host Your Own Server?</a>
            <a onclick="window.alert('not implemented yet');" class="button-link">Want To Host Your Own Server?</a> -->
        </div>
        <div id="credits-modal" class="modal" hidden>
            <div>
                <div style="max-height: 60vh;overflow-y: scroll;">
                    Territopple is inspired by the game <a href="https://web.archive.org/web/20081001161951/http://secretlab.com.au/culture/" target="_blank">Culture by Secret Lab Pty. Ltd.</a><br><br>
                    Logo / Tab Icon:<br>
                    <ul class="credit-list"><li>Vihaan Jim</li></ul>
                    Direction:<br>
                    <ul class="credit-list"><li>Andrew Rivera</li></ul>
                    Programming:<br>
                    <ul class="credit-list">
                        <li>Tristan Schartman</li>
                        <li>Andrew Rivera</li>
                        <li>Vihaan Jim</li>
                    </ul>
                    Systems Testing:<br>
                    <ul class="credit-list">
                        <li>Tristan Schartman</li>
                    </ul>
                    Gameplay Testing:<br>
                    <ul class="credit-list">
                        <li>Andrew 'Ready Player One' Rivera</li>
                        <li>Vihaan 'That Was Not The Move' Jim</li>
                        <li>Tristan 'It'll Be Fine' Schartman</li>
                    </ul>
                    Special Thanks:<br>
                    <ul class="credit-list">
                        <li>CheriBerry77 (aka captainberry)</li>
                    </ul>
                </div><br>
                <input type="button" value="close" onclick="document.getElementById('credits-modal').hidden=true;">
            </div>
        </div>
        <div id="changelog-modal" class="modal" hidden>
            <div style="max-height: 60vh;overflow-y: scroll;">
                <p></p>
                <br>
                <input type="button" value="close" onclick="document.getElementById('changelog-modal').hidden=true;">
            </div>
            <script>
                fetch("https://territopple.net/changelog.txt", {method:"GET"}).then(v => {
                    v.text().then(t => {
                        const p = document.getElementById("changelog-modal").children[0].children[0];
                        t.split("\n").forEach(v => {
                            const l = v.trim();
                            if (l.length) {
                                if (l[0] === "#") {
                                    const h = document.createElement("h3");
                                    h.textContent = l.substring(1);
                                    p.append(h);
                                } else {
                                    p.append(l, document.createElement("br"));
                                }
                            }
                        });
                    });
                });
            </script>
        </div>
        <div id="cookie-modal" class="modal" hidden>
            <div>
                We use cookies for authentication.<br><br>
                <input type="button" value="close" onclick="document.getElementById('cookie-modal').hidden=true;">
            </div>
        </div>
        <div id="contact-modal" class="modal" hidden>
            <!-- actual content -->
            <div>
                <input type="button" value="close" onclick="document.getElementById('contact-modal').hidden=true;">
            </div>
        </div>
        <div id="coming-soon-modal" class="modal" hidden>
            <div>
                Coming Soon!<br><br>
                <input type="button" value="close" onclick="document.getElementById('coming-soon-modal').hidden=true;">
            </div>
        </div>
        <script src="/portno.js"></script>
        <script src="/components/include.js"></script>
        <script>
            const contact_modal = document.getElementById("contact-modal");
            /**
             * @param {string} nodename
             * @param {Record<string,string>} props
             * @returns {HTMLElement}
             */
            function makeNode(nodename, props) {
                const node = document.createElement(nodename);
                if (props) {
                    if ("append" in props) {
                        if (Array.isArray(props.append)) node.append(...props.append);
                        else node.append(props.append);
                        delete props["append"];
                    }
                    for (const k in props) {
                        node[k] = props[k];
                    }
                }
                return node;
            }
            /**
             * @param {[string, string]} v
             * @returns HTMLElement
             */
            function makeContact(v) {
                switch (v[0]) {
                    case "email":{
                        const str = `mailto:${v[1]}`;
                        return makeNode("li",{append:["email: ",makeNode("a",{href:str,textContent:v[1],className:"perma-blue"})]});
                    }
                    default:return makeNode("li",{textContent:`${v[0]}: ${v[1]}`});
                }
            }
            fetch(`https://${document.location.hostname}/operator.json`).then(v => {
                v.text().then(t => {
                    const info = JSON.parse(t);
                    let nodes = [];
                    if (info.contact) {
                        nodes.push(makeNode("p", {textContent:`Operator Name: ${info.contact.name}`}));
                        nodes.push(makeNode("p", {append:["Contact Methods",makeNode("ul",{append:Object.entries(info.contact.methods||{}).map(v => makeContact(v))})]}));
                        // nodes.push();
                    } else {
                        nodes.push(makeNode("p", {textContent:"no contact information is available"}));
                    }
                    contact_modal.children[0].prepend(...nodes);
                });
            });
        </script>
    </body>
</html>
